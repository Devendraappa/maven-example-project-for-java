name: Maven Build and Testing

on:
  pull_request:
    branches:
      - master

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v3

# Conditional step based on pull request action
      - name: Handle Pull Request Actions
        run: |
          if [[ "${{ github.event.action }}" == "opened" ]]; then
            echo "Pull request opened on branch ${{ github.ref_name }}."
            # Add commands to handle 'opened' event
          elif [[ "${{ github.event.action }}" == "reopened" ]]; then
            echo "Pull request reopened on branch ${{ github.ref_name }}."
            # Add commands to handle 'reopened' event
          elif [[ "${{ github.event.action }}" == "closed" ]]; then
            if [[ "${{ github.event.pull_request.merged }}" == "true" ]]; then
              echo "Pull request merged into branch ${{ github.base_ref }}."
              # Add commands to handle merged PR
            else
              echo "Pull request closed without merging."
              # Add commands to handle PR closed without merging
            fi
          fi
      - name: Set up JDK
        uses: actions/setup-java@v3
        with:
          java-version: 17
          distribution: temurin

      - name: Cache Maven dependencies
        uses: actions/cache@v3
        with:
          path: ~/.m2/repository
          key: ${{ runner.os }}-maven-${{ hashFiles('**/pom.xml') }}
          restore-keys: |
            ${{ runner.os }}-maven-

      - name: Build with Maven
        run: mvn clean install

      - name: Run Tests
        run: mvn test    
